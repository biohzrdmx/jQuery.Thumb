/**
 * jQuery.Thumb
 * @version   1.0
 * @author    biohzrdmx <github.com/biohzrdmx>
 * @requires  jQuery 1.8+
 * @license   MIT
 * @copyright Copyright Â© 2018 biohzrdmx. All rights reserved.
 */
;!function(e){e.thumb={api:{fromInput:function(t,i){if(void 0!==window.FileReader&&t.files&&t.files[0]&&t.files[0].type.match(/^image\/(jpe?g|png|gif|webp|svg)/)){var a=new FileReader;a.onload=function(t){e.thumb.api.fromDataURL(t.target.result,i)},a.readAsDataURL(t.files[0])}},fromDataURL:function(e,t){var i=new Image;i.onload=function(e){t.callbacks.onLoad(i,t)},i.src=e},resize:function(t,i){var a,n,h,o,r,g,c,d,s,m,f,l,u,w,p;switch(a=document.createElement("canvas"),n=document.createElement("canvas"),w=0,i.orientation){case 3:case 4:w=180;break;case 5:case 6:w=90;break;case 7:case 8:w=270}switch(a.width=90==w||270==w?t.height:t.width,a.height=90==w||270==w?t.width:t.height,n.width=i.width,n.height=i.height,h=a.getContext("2d"),o=n.getContext("2d"),r=0,g=0,c=a.width,d=a.height,i.fitMode){case e.thumb.FitModes.FitLong:f=Math.min(n.width/c,n.height/d);break;case e.thumb.FitModes.FitShort:default:f=Math.max(n.width/c,n.height/d)}s=i.keepRatio?c*f:n.width,m=i.keepRatio?d*f:n.height,i.center&&(l=c/s,u=d/m,r=(c-n.width*l)/2,g=(d-n.height*u)/2),o.imageSmoothingQuality="high",o.mozImageSmoothingEnabled=!i.pixelPerfect,o.webkitImageSmoothingEnabled=!i.pixelPerfect,o.msImageSmoothingEnabled=!i.pixelPerfect,o.imageSmoothingEnabled=!i.pixelPerfect,0!=w?(h.save(),90==w||270==w?h.translate(t.height/2,t.width/2):h.translate(t.width/2,t.height/2),h.rotate(w*Math.PI/180),h.drawImage(t,-t.width/2,-t.height/2),h.restore()):h.drawImage(t,0,0),o.drawImage(a,r,g,c,d,0,0,s,m),(p=new Image).onload=function(t){var a="string"==typeof i.preview?e(i.preview):i.preview;i.callbacks.onResize(a,p,i)},p.src=n.toDataURL()}},defaults:{width:180,height:180,center:!1,preview:null,fitMode:1,keepRatio:!0,pixelPerfect:!1,orientation:0,callbacks:{onLoad:function(t,i){"undefined"!=typeof EXIF?EXIF.getData(t,function(){i.orientation=EXIF.getTag(this,"Orientation"),e.thumb.api.resize(t,i)}):(i.orientation=-1,e.thumb.api.resize(t,i))},onResize:function(e,t,i){var a=e.find("img");a.length?a.replaceWith(t):e.append(t)}}}},e.thumb.FitModes={FitLong:0,FitShort:1},e.fn.thumb=function(t){if(!this.length)return this;var i=e.extend(!0,{},e.thumb.defaults,t);return this.each(function(){var t=e(this);t.on("change",function(){e.thumb.api.fromInput(t.get(0),i)})}),this}}(jQuery);